FROM node:18-alpine

# Declare build arguments after FROM so they are in the correct scope
ARG NEXT_PUBLIC_WEBSITE_NAME
ARG NEXT_PUBLIC_PHONE_NUMBER
ARG NEXT_PUBLIC_CONTACT_EMAIL
ARG NEXT_PUBLIC_HOURS_SATURDAY
ARG NEXT_PUBLIC_HOURS_SUNDAY
ARG NEXT_PUBLIC_API_URL
ARG NEXT_PUBLIC_NETWORK_MONITORING_COST
ARG NEXT_PUBLIC_NETWORK_INSTALLATION_COST
ARG NEXT_PUBLIC_CUSTOM_SOFTWARE_COST

# Set them as environment variables
ENV NEXT_PUBLIC_WEBSITE_NAME=$NEXT_PUBLIC_WEBSITE_NAME
ENV NEXT_PUBLIC_PHONE_NUMBER=$NEXT_PUBLIC_PHONE_NUMBER
ENV NEXT_PUBLIC_CONTACT_EMAIL=$NEXT_PUBLIC_CONTACT_EMAIL
ENV NEXT_PUBLIC_HOURS_SATURDAY=$NEXT_PUBLIC_HOURS_SATURDAY
ENV NEXT_PUBLIC_HOURS_SUNDAY=$NEXT_PUBLIC_HOURS_SUNDAY
ENV NEXT_PUBLIC_API_URL=$NEXT_PUBLIC_API_URL
ENV NEXT_PUBLIC_NETWORK_MONITORING_COST=$NEXT_PUBLIC_NETWORK_MONITORING_COST
ENV NEXT_PUBLIC_NETWORK_INSTALLATION_COST=$NEXT_PUBLIC_NETWORK_INSTALLATION_COST
ENV NEXT_PUBLIC_CUSTOM_SOFTWARE_COST=$NEXT_PUBLIC_CUSTOM_SOFTWARE_COST

WORKDIR /app

COPY package*.json ./
RUN npm install

COPY . .
RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
